<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edge TTS - Text to Speech Converter</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.replit.com/agent/bootstrap-agent-dark-theme.min.css" rel="stylesheet">
    
    <!-- Custom CSS -->
    <link href="{{ url_for('static', filename='css/custom.css') }}" rel="stylesheet">
    
    <!-- Font Awesome Icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <div class="container my-4">
        <header class="text-center mb-5">
            <h1 class="display-4">
                <i class="fas fa-volume-up me-2"></i>Edge TTS Converter
            </h1>
            <p class="lead">Convert text to natural-sounding speech with Microsoft Edge TTS</p>
        </header>

        <!-- Flash messages -->
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="alert alert-{{ category if category != 'error' else 'danger' }} alert-dismissible fade show" role="alert">
                        {{ message }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}

        <div class="row">
            <div class="col-lg-8 mx-auto">
                <div class="card border-0 shadow-sm mb-4">
                    <div class="card-header bg-secondary bg-opacity-25">
                        <h2 class="h5 mb-0">Text to Speech Converter</h2>
                    </div>
                    <div class="card-body">
                        <form id="ttsForm" action="{{ url_for('convert_text') }}" method="post">
                            <div class="mb-3">
                                <label for="text" class="form-label">Enter Text</label>
                                <textarea class="form-control" id="text" name="text" rows="5" placeholder="Type or paste your text here..." required>{{ text if text else '' }}</textarea>
                            </div>
                            <div class="row mb-3">
                                <div class="col-md-8">
                                    <label for="voice" class="form-label">Select Voice</label>
                                    <select class="form-select" id="voice" name="voice">
                                        {% if voices %}
                                            {% for voice in voices %}
                                                <option value="{{ voice.name }}" 
                                                    {% if selected_voice == voice.name %}selected{% endif %}>
                                                    {{ voice.display_name }}
                                                </option>
                                            {% endfor %}
                                        {% else %}
                                            <option value="">No voices available</option>
                                        {% endif %}
                                    </select>
                                </div>
                                <div class="col-md-4">
                                    <label for="format" class="form-label">Audio Format</label>
                                    <select class="form-select" id="format" name="format">
                                        <option value="mp3" {% if selected_format == 'mp3' %}selected{% endif %}>MP3</option>
                                        <option value="wav" {% if selected_format == 'wav' %}selected{% endif %}>WAV</option>
                                    </select>
                                </div>
                            </div>
                            <div class="d-grid gap-2">
                                <button type="submit" class="btn btn-primary" id="convertBtn">
                                    <i class="fas fa-sync-alt me-2"></i>Convert
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Audio Player Section -->
                {% if audio_url %}
                <div class="card border-0 shadow-sm mb-4">
                    <div class="card-header bg-secondary bg-opacity-25">
                        <h2 class="h5 mb-0">Generated Audio</h2>
                    </div>
                    <div class="card-body">
                        <div class="text-center mb-3">
                            <audio id="audioPlayer" controls class="w-100 mb-3">
                                <source src="{{ audio_url }}" type="audio/{{ 'mpeg' if selected_format == 'mp3' else 'wav' }}">
                                Your browser does not support the audio element.
                            </audio>
                        </div>
                        <div class="d-flex justify-content-center">
                            <a href="{{ audio_url }}" class="btn btn-success" download>
                                <i class="fas fa-download me-2"></i>Download Audio
                            </a>
                        </div>
                    </div>
                </div>
                {% endif %}

                <!-- API Usage Section -->
                <div class="card border-0 shadow-sm">
                    <div class="card-header bg-secondary bg-opacity-25">
                        <h2 class="h5 mb-0">API Usage</h2>
                    </div>
                    <div class="card-body">
                        <p>You can also use our API to convert text to speech programmatically:</p>
                        
                        <!-- API Key Section -->
                        <div class="alert alert-info mb-4">
                            <h6 class="mb-2"><i class="fas fa-key me-2"></i>Your API Key:</h6>
                            <div class="input-group">
                                <input type="text" class="form-control font-monospace" id="apiKeyField" readonly value="{{ api_key }}">
                                <button class="btn btn-outline-secondary" type="button" id="copyApiKeyBtn">
                                    <i class="fas fa-copy me-1"></i> Copy
                                </button>
                            </div>
                            <div class="mt-2 small">
                                <strong>Note:</strong> This key is required for all API requests. Include it in your request headers as <code>X-API-Key</code> or as a query parameter <code>api_key</code>.
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <h6>Authentication:</h6>
                            <div class="bg-dark p-2 rounded mb-2">
                                <code>Header: X-API-Key: YOUR_API_KEY</code>
                            </div>
                            <div class="bg-dark p-2 rounded">
                                <code>Or: ?api_key=YOUR_API_KEY</code>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <h6>Endpoint:</h6>
                            <div class="bg-dark p-2 rounded">
                                <code>POST /api/tts</code>
                            </div>
                        </div>
                        <div class="mb-3">
                            <h6>Request Body (JSON):</h6>
                            <pre class="bg-dark p-2 rounded"><code>{
  "text": "Your text to convert",
  "voice": "en-US-ChristopherNeural",
  "format": "mp3"
}</code></pre>
                        </div>
                        <div class="mb-3">
                            <h6>Response:</h6>
                            <pre class="bg-dark p-2 rounded"><code>{
  "success": true,
  "file_url": "/audio/filename.mp3"
}</code></pre>
                        </div>
                        <div class="mb-3">
                            <h6>Get available voices:</h6>
                            <div class="bg-dark p-2 rounded mb-2">
                                <code>GET /api/voices</code>
                            </div>
                        </div>
                        
                        <!-- Example Request Section -->
                        <div class="mb-3">
                            <h6>Example cURL Request:</h6>
                            <pre class="bg-dark p-2 rounded"><code>curl -X POST \
  "{{ request.host_url }}api/tts" \
  -H "X-API-Key: {{ api_key }}" \
  -H "Content-Type: application/json" \
  -d '{"text": "Hello world", "voice": "en-US-ChristopherNeural", "format": "mp3"}'</code></pre>
                        </div>
                        
                        <!-- API Documentation Link -->
                        <div class="text-center mt-4">
                            <a href="{{ url_for('api_docs') }}" class="btn btn-primary">
                                <i class="fas fa-book me-2"></i>View Complete API Documentation
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="bg-dark py-4 mt-5">
        <div class="container text-center">
            <p class="text-muted mb-0">Edge TTS Converter | Powered by Microsoft Edge TTS</p>
        </div>
    </footer>

    <!-- Bootstrap JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Custom JavaScript -->
    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
</body>
</html>
